"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e,r,a,n,o,i,s,u=require("bignumber.js"),c=require("ethers"),p=t(require("dayjs")),l=require("ethers/lib/utils"),d=t(require("gray-matter"));(e=exports.ChainIdByName||(exports.ChainIdByName={}))[e.Goerli=5]="Goerli",e[e.GoerliOptimism=420]="GoerliOptimism",e[e.AvalancheFuji=43113]="AvalancheFuji",e[e.Sepolia=11155111]="Sepolia",e[e.Mumbai=80001]="Mumbai",e[e.BnbTest=97]="BnbTest";var f,m,h,x,g,v,y,b={goerli:{contractAddress:"0x586207Df62c7D5D1c9dBb8F61EdF77cc30925C4F",dataHelperContractAddress:"0x160e2d1456B815d6a3d281218538dd6E2e3C841f",votingPortals:(r={},r[exports.ChainIdByName.Goerli]="0xFf376b6db4AF0d87Dba35860B3B87F526d7879cF",r)},sepolia:{contractAddress:"0x84b3FE5eD74caC496BcB58d448A7c83c523F6E0E",dataHelperContractAddress:"0x74bb7b600fA33E2A1945F8493D17db3b129513D2",votingPortals:(a={},a[exports.ChainIdByName.Sepolia]="0x5C77bF8505716904a1a73eB8c3909c0Da0DD49b3",a)}},P={goerli:(n={},n[exports.ChainIdByName.Goerli]={dataHelperContractAddress:"0xbd2db358f3C82F2883132A6584e22F38A979e768",contractAddresses:["0x064361B3761CcDd17300146bf58a79d1E570382E"],payloadAddress:"0xf6b9c3fCF7f91817E7bF0efF792BA692c7bd372A"},n),sepolia:(o={},o[exports.ChainIdByName.Sepolia]={dataHelperContractAddress:"0x5c2AD703961c59Adb4412d402b8D694Eee48a822",contractAddresses:["0x7Bb94b2a8d9fD3f37345Ec5A0b46c234164b4f90"],payloadAddress:"0xf19de078dbac9db382caf8015cb208667ec581c0"},o)},w={goerli:(i={},i[exports.ChainIdByName.Goerli]={contractAddress:"0xE8AD5ab6295c16D04257BC6Cd6D447ff4018FF89",dataHelperContractAddress:"0xe10617A1ea760E174E82fBeb38a540d8ACe566f5",dataWarehouseAddress:"0xC946cc6bb934bAf2A539BaB62c647aff09D2e2D8"},i),sepolia:(s={},s[exports.ChainIdByName.Sepolia]={contractAddress:"0xB379f8a3E62Ff807E827F853B36688d1d7aD692f",dataHelperContractAddress:"0x8b5661024Bc97c1Fd71B4eCafCA88c316c3D438B",dataWarehouseAddress:"0xdF6C1affD18Ecb318e4468d96b588bbbEac180E2"},s)},S={goerli:exports.ChainIdByName.Goerli,sepolia:exports.ChainIdByName.Sepolia},D={goerli:{aaveAddress:"0xb6D88BfC5b145a558b279cf7692e6F02064889d0",aAaveAddress:"0xD1ff82609FB63A0eee6FE7D2896d80d29491cCCd",stkAAVEAddress:"0x1406A9Ea2B0ec8FD4bCa4F876DAae2a70a9856Ec",delegationHelper:"0x1966133c190475E8385Dc1b4150B5f81c70DC578"},sepolia:{aaveAddress:"0x64033B2270fd9D6bbFc35736d2aC812942cE75fE",aAaveAddress:"0x7d9EB767eEc260d1bCe8C518276a894aE5535F04",stkAAVEAddress:"0xA4FDAbdE9eF3045F0dcF9221bab436B784B7e42D",delegationHelper:"0x1633Bd6772020a797fB09a3b17D6AD9a95b98f01"}},E={goerli:[exports.ChainIdByName.Goerli],sepolia:[exports.ChainIdByName.Sepolia]},C={goerli:[exports.ChainIdByName.Goerli],sepolia:[exports.ChainIdByName.Sepolia]},k={testnet:"qGvvlJMoyDKyuMxqJjDwFslpgiBKZCXNXpnSjIxsICY_",mainnet:""};function N(t){return t instanceof u.BigNumber?t:new u.BigNumber(t)}function A(t,e){return N(t).shiftedBy(-1*e)}function B(t){return{notZero:t!==c.ethers.constants.HashZero,zero:t===c.ethers.constants.HashZero}}function F(){F=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o=Object.create((e&&e.prototype instanceof d?e:d).prototype),i=new E(n||[]);return a(o,"_invoke",{value:P(t,r,i)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function d(){}function f(){}function m(){}var h={};u(h,o,(function(){return this}));var x=Object.getPrototypeOf,g=x&&x(x(C([])));g&&g!==e&&r.call(g,o)&&(h=g);var v=m.prototype=d.prototype=Object.create(h);function y(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var n;a(this,"_invoke",{value:function(a,o){function i(){return new e((function(n,i){!function a(n,o,i,s){var u=p(t[n],t,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){a("next",t,i,s)}),(function(t){a("throw",t,i,s)})):e.resolve(l).then((function(t){c.value=t,i(c)}),(function(t){return a("throw",t,i,s)}))}s(u.arg)}(a,o,n,i)}))}return n=n?n.then(i,i):i()}})}function P(t,e,r){var a="suspendedStart";return function(n,o){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===n)throw o;return{value:void 0,done:!0}}for(r.method=n,r.arg=o;;){var i=r.delegate;if(i){var s=w(i,r);if(s){if(s===l)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===a)throw a="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a="executing";var u=p(t,e,r);if("normal"===u.type){if(a=r.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,a=t.iterator[r];if(void 0===a)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),l;var n=p(a,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,n=function e(){for(;++a<t.length;)if(r.call(t,a))return e.value=t[a],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return f.prototype=m,a(v,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,s,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},y(b.prototype),u(b.prototype,i,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,a,n,o){void 0===o&&(o=Promise);var i=new b(c(e,r,a,n),o);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},y(v),u(v,s,"Generator"),u(v,o,(function(){return this})),u(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},t.values=C,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(D),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function a(r,a){return i.type="throw",i.arg=t,e.next=r,a&&(e.method="next",e.arg=void 0),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var n=this.tryEntries[a];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var n=a.arg;D(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:C(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}function T(t,e,r,a,n,o,i){try{var s=t[o](i),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(a,n)}function V(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var o=t.apply(e,r);function i(t){T(o,a,n,i,s,"next",t)}function s(t){T(o,a,n,i,s,"throw",t)}i(void 0)}))}}function M(){return(M=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t}).apply(this,arguments)}function I(t,e,r,a){return q.apply(this,arguments)}function q(){return(q=V(F().mark((function t(e,r,a,n){var o,i,s;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o=Math.ceil((r-e)/a),i=new Array(o),s=0;s<o;s++)i[s]=s;return t.next=5,Promise.all(i.map(function(){var t=V(F().mark((function t(o){var i,s;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e+a*o,s=e+(a*o+a),t.next=4,n(i,r>s?s:r);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return t.abrupt("return",t.sent.flat());case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function H(t,e){return{forVotes:A(t,18).toNumber(),againstVotes:A(e,18).toNumber()}}function L(t,e,r){var a=N(e).multipliedBy(r),n=A(a,18).toNumber(),o=!1;return N(t).gte(a)&&(o=!0),{minQuorumVotes:a,normalizeMinQuorumVotes:n,quorumReached:o}}function W(t,e,r,a){var n=N(t).minus(e),o=N(r).multipliedBy(a);return{diff:n,requiredDiff:o,normalizeRequiredDiff:A(o,18).toNumber()}}function G(t){var e=t.proposalData,r=t.quorum,a=t.differential,n=t.precisionDivider,o=t.cooldownPeriod,i=t.executionPayloadTime,s=p().unix(),u=e.votingMachineState>exports.VotingMachineProposalState.NotCreated,c=e.votingMachineData.endTime>0&&s>e.votingMachineData.endTime,l=e.votingMachineData.votingClosedAndSentTimestamp>0&&s>e.votingMachineData.votingClosedAndSentTimestamp,d=H(e.votingMachineData.forVotes,e.votingMachineData.againstVotes),f=d.forVotes,m=d.againstVotes,h=L(e.votingMachineData.forVotes,r,n),x=h.normalizeMinQuorumVotes,g=h.quorumReached,v=W(e.votingMachineData.forVotes,e.votingMachineData.againstVotes,a,n).normalizeRequiredDiff,y=Math.max.apply(null,e.payloads.map((function(t){return(null==t?void 0:t.queuedAt)||0}))),b=Math.max.apply(null,e.payloads.map((function(t){return(null==t?void 0:t.executedAt)||0}))),P=Math.max.apply(null,e.payloads.map((function(t){return(null==t?void 0:t.cancelledAt)||0}))),w=Math.max.apply(null,e.payloads.map((function(t){return null!=t&&t.executedAt?t.queuedAt<=0&&t.state===exports.PayloadState.Expired?t.expirationTime:t.queuedAt>0&&t.state===exports.PayloadState.Expired?t.queuedAt+t.delay+t.gracePeriod:0:0}))),S=Math.max.apply(null,e.payloads.map((function(t){return null!=t&&t.state&&t.state===exports.PayloadState.Created?t.expirationTime:null!=t&&t.state&&t.state===exports.PayloadState.Queued?t.queuedAt+t.delay+t.gracePeriod:0}))),D=e.payloads.every((function(t){return(null==t?void 0:t.state)&&t.state===exports.PayloadState.Executed})),E=e.payloads.every((function(t){return(null==t?void 0:t.state)&&t.state===exports.PayloadState.Cancelled})),C=e.payloads.every((function(t){return(null==t?void 0:t.state)&&t.state===exports.PayloadState.Expired})),k=e.basicState===exports.BasicProposalState.Cancelled||E,N=e.basicState===exports.BasicProposalState.Expired||C,A=c&&(m>f+v||0===m&&0===f),B=c&&l&&!A&&e.basicState===exports.BasicProposalState.Executed&&!k,F=c&&l&&!A&&e.basicState===exports.BasicProposalState.Executed&&!k&&D&&!N,T=!0;return(e.basicState===exports.BasicProposalState.Null||e.basicState===exports.BasicProposalState.Created||k||A||F||N)&&(T=!1),{forVotes:f,againstVotes:m,normalizeMinQuorumVotes:x,quorumReached:g,normalizeRequiredDiff:v,isVotingStarted:u,isVotingActive:u&&!c&&!k,isVotingEnded:c,isVotingClosed:l,isVotingFailed:A,lastPayloadQueuedAt:y,lastPayloadCanceledAt:P,lastPayloadExecutedAt:b,lastPayloadExpiredAt:w,predictPayloadExpiredTime:S,allPayloadsExecuted:D,allPayloadsCanceled:E,allPayloadsExpired:C,isCanceled:k,isExpired:N,isProposalActive:T,isProposalQueued:u&&c&&l&&e.votingMachineData.sentToGovernance&&e.queuingTime>0&&s>e.queuingTime+o,isProposalExecuted:B,isPayloadsQueued:B&&s>y+i,isPayloadsExecuted:F}}function Q(t,e,r){var a=p().unix(),n=G({proposalData:t.data,quorum:t.config.quorum,differential:t.config.differential,precisionDivider:t.precisionDivider,cooldownPeriod:t.timings.cooldownPeriod,executionPayloadTime:t.timings.executionPayloadTime}),o=n.isVotingStarted,i=n.isVotingEnded,s=n.isVotingClosed,u=n.lastPayloadQueuedAt,c=n.predictPayloadExpiredTime,l=H(e,r),d=l.forVotes,f=l.againstVotes,m=L(e,t.config.quorum,t.precisionDivider).quorumReached,h=W(e,r,t.config.differential,t.precisionDivider).normalizeRequiredDiff,x=f>d+h||0===f&&0===d||!m,g=t.data.basicState===exports.BasicProposalState.Executed&&a<u+t.timings.executionPayloadTime,v=t.data.queuingTime>0&&0===u?t.data.queuingTime+t.timings.cooldownPeriod:t.data.queuingTime>0&&u>0?u+t.timings.executionPayloadTime:0;return a<=t.data.creationTime+t.config.coolDownBeforeVotingStart?{estimatedState:exports.ProposalEstimatedState.Active,timestampForEstimatedState:t.data.creationTime+t.config.coolDownBeforeVotingStart}:o&&!i&&d>f+h&&m?{estimatedState:exports.ProposalEstimatedState.Succeed,timestampForEstimatedState:t.data.votingMachineData.endTime}:x&&o&&!i?{estimatedState:exports.ProposalEstimatedState.Defeated,timestampForEstimatedState:t.data.votingMachineData.endTime}:o&&i&&s&&!x&&t.data.votingMachineData.sentToGovernance&&t.data.queuingTime>0&&a<t.data.queuingTime+t.timings.cooldownPeriod&&!g?{estimatedState:exports.ProposalEstimatedState.ProposalExecuted,timestampForEstimatedState:v}:g?{estimatedState:exports.ProposalEstimatedState.PayloadsExecuted,timestampForEstimatedState:v}:{estimatedState:exports.ProposalEstimatedState.Expired,timestampForEstimatedState:t.data.basicState===exports.BasicProposalState.Executed?c:t.data.creationTime+t.timings.expirationTime}}function j(t){var e=p().unix(),r=G({proposalData:t.data,quorum:t.config.quorum,differential:t.config.differential,precisionDivider:t.precisionDivider,cooldownPeriod:t.timings.cooldownPeriod,executionPayloadTime:t.timings.executionPayloadTime}),a=r.isVotingStarted,n=r.isVotingEnded,o=r.isVotingClosed;return r.isVotingFailed?void 0:e>t.data.creationTime+t.config.coolDownBeforeVotingStart&&!a&&!n&&!o?exports.ProposalWaitForState.WaitForActivateVoting:a&&n&&!o?exports.ProposalWaitForState.WaitForCloseVoting:a&&n&&o&&t.data.votingMachineData.sentToGovernance&&t.data.queuingTime<=0?exports.ProposalWaitForState.WaitForQueueProposal:r.isProposalQueued&&t.data.basicState!==exports.BasicProposalState.Executed?exports.ProposalWaitForState.WaitForExecuteProposal:r.isProposalExecuted&&0===r.lastPayloadQueuedAt?exports.ProposalWaitForState.WaitForQueuePayloads:r.isPayloadsQueued?exports.ProposalWaitForState.WaitForExecutePayloads:void 0}(f=exports.BasicProposalState||(exports.BasicProposalState={}))[f.Null=0]="Null",f[f.Created=1]="Created",f[f.Active=2]="Active",f[f.Queued=3]="Queued",f[f.Executed=4]="Executed",f[f.Failed=5]="Failed",f[f.Cancelled=6]="Cancelled",f[f.Expired=7]="Expired",(m=exports.VotingMachineProposalState||(exports.VotingMachineProposalState={}))[m.NotCreated=0]="NotCreated",m[m.Active=1]="Active",m[m.Finished=2]="Finished",m[m.SentToGovernance=3]="SentToGovernance",(h=exports.PayloadState||(exports.PayloadState={}))[h.None=0]="None",h[h.Created=1]="Created",h[h.Queued=2]="Queued",h[h.Executed=3]="Executed",h[h.Cancelled=4]="Cancelled",h[h.Expired=5]="Expired",(x=exports.ProposalState||(exports.ProposalState={}))[x.Created=0]="Created",x[x.Active=1]="Active",x[x.Succeed=2]="Succeed",x[x.Defeated=3]="Defeated",x[x.Executed=4]="Executed",x[x.Expired=5]="Expired",x[x.Canceled=6]="Canceled",(g=exports.ProposalStateWithName||(exports.ProposalStateWithName={})).Created="Created",g.Active="Voting",g.Succeed="Passed",g.Failed="Failed",g.Defeated="Failed",g.Executed="Executed",g.Expired="Expired",g.Canceled="Canceled",g.ActiveAll="Active",(v=exports.ProposalEstimatedState||(exports.ProposalEstimatedState={})).Active="Will open for voting",v.Succeed="Will pass",v.Defeated="Will fail",v.ProposalExecuted="Proposal will be executed",v.PayloadsExecuted="Payloads will be executed",v.Expired="Will expire",(y=exports.ProposalWaitForState||(exports.ProposalWaitForState={})).WaitForActivateVoting="Pending voting activation",y.WaitForCloseVoting="Pending voting closure",y.WaitForQueueProposal="Proposal is time-locked",y.WaitForExecuteProposal="Pending proposal execution",y.WaitForQueuePayloads="Payloads are time-locked",y.WaitForExecutePayloads="Pending payloads execution";var O=function(t){switch(t){case exports.ChainIdByName.Sepolia:return 15;case exports.ChainIdByName.AvalancheFuji:return 5;case exports.ChainIdByName.Mumbai:case exports.ChainIdByName.BnbTest:return 3;default:return 15}};function _(){return(_=V(F().mark((function t(e,r,a){var n,o,i,s,u,c,p,l,d,f,m,h;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=100,o=10,i=0,s=O(e),t.next=6,a.getBlockNumber();case 6:return u=t.sent,t.next=9,a.getBlock(u);case 9:if(!(r>(c=t.sent).timestamp)){t.next=12;break}throw new Error("Target timestamp is in the future.");case 12:return p=Math.max(0,u-Math.floor((c.timestamp-r)/s)),t.next=15,a.getBlock(p);case 15:l=t.sent,d=c.timestamp,f=u;do{i++}while(Math.abs(l.timestamp-r)>n*s&&i<o);case 19:if(!(Math.abs(l.timestamp-r)>n*s&&i<o)){t.next=30;break}return s=(l.timestamp-d)/(p-f),d=l.timestamp,f=l.number,p=Math.max(0,p-Math.floor((l.timestamp-r)/s)),t.next=26,a.getBlock(p);case 26:l=t.sent,i++,t.next=19;break;case 30:if(i!==o){t.next=32;break}throw new Error("Maximum iterations reached without converging.");case 32:return m=l.number-1,h=l.number+2*n,l.timestamp>r&&(m=l.number-2*n,h=l.number),t.abrupt("return",{minBlockNumber:m,maxBlockNumber:h});case 36:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function R(){return(R=V(F().mark((function t(e,r){var a,n,o,i,s,u,c;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=[1,2],t.next=3,e.getConstants(r,a);case 3:for(o={precisionDivider:(n=t.sent).precisionDivider.toString(),cooldownPeriod:n.cooldownPeriod.toNumber(),expirationTime:n.expirationTime.toNumber(),cancellationFee:n.cancellationFee.toString()},i=[],s=0;s<a.length;s++)c={accessLevel:(u=n.votingConfigs[s]).accessLevel,votingDuration:u.config.votingDuration,quorum:u.config.yesThreshold.toNumber()||200,differential:u.config.yesNoDifferential.toNumber()||50,coolDownBeforeVotingStart:u.config.coolDownBeforeVotingStart,minPropositionPower:u.config.minPropositionPower.toNumber()},i.push(c);return t.abrupt("return",{contractsConstants:o,configs:i});case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function z(t,e,r,a,n){return Z.apply(this,arguments)}function Z(){return(Z=V(F().mark((function t(e,r,a,n,o){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.queryFilter(a.filters.PayloadCreated(),e,r);case 2:return t.abrupt("return",t.sent.sort((function(t,e){return e.blockNumber-t.blockNumber})).map((function(t){return{payloadId:t.args.payloadId,chainId:o,transactionHash:t.transactionHash,blockNumber:t.blockNumber,payloadsController:n}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function K(){return(K=V(F().mark((function t(e,r,a,n,o){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I(e,r,1023,function(){var t=V(F().mark((function t(e,r){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z(e,r,a,n,o);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Y(t,e,r){return J.apply(this,arguments)}function J(){return(J=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.queryFilter(a.filters.ProposalCreated(),e,r);case 2:return t.abrupt("return",t.sent.sort((function(t,e){return e.blockNumber-t.blockNumber})).map((function(t){return{proposalId:t.args.proposalId.toNumber(),transactionHash:t.transactionHash,blockNumber:t.blockNumber}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function X(){return(X=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I(e,r,1023,function(){var t=V(F().mark((function t(e,r){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y(e,r,a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function U(t,e,r){return $.apply(this,arguments)}function $(){return($=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.queryFilter(a.filters.VotingActivated(),e,r);case 2:return t.abrupt("return",t.sent.sort((function(t,e){return e.blockNumber-t.blockNumber})).map((function(t){return{proposalId:t.args.proposalId.toNumber(),transactionHash:t.transactionHash,blockNumber:t.blockNumber}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function tt(){return(tt=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I(e,r,1023,function(){var t=V(F().mark((function t(e,r){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U(e,r,a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function et(t,e,r){return rt.apply(this,arguments)}function rt(){return(rt=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.queryFilter(a.filters.ProposalVoteStarted(),e,r);case 2:return t.abrupt("return",t.sent.sort((function(t,e){return e.blockNumber-t.blockNumber})).map((function(t){return{proposalId:t.args.proposalId.toNumber(),transactionHash:t.transactionHash,blockNumber:t.blockNumber}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function at(){return(at=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I(e,r,1023,function(){var t=V(F().mark((function t(e,r){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,et(e,r,a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function nt(t,e,r){return ot.apply(this,arguments)}function ot(){return(ot=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.queryFilter(a.filters.ProposalResultsSent(),e,r);case 2:return t.abrupt("return",t.sent.sort((function(t,e){return e.blockNumber-t.blockNumber})).map((function(t){return{proposalId:t.args.proposalId.toNumber(),transactionHash:t.transactionHash,blockNumber:t.blockNumber}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function it(){return(it=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I(e,r,1023,function(){var t=V(F().mark((function t(e,r){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nt(e,r,a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function st(t,e,r){return ut.apply(this,arguments)}function ut(){return(ut=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.queryFilter(a.filters.ProposalQueued(),e,r);case 2:return t.abrupt("return",t.sent.sort((function(t,e){return e.blockNumber-t.blockNumber})).map((function(t){return{proposalId:t.args.proposalId.toNumber(),transactionHash:t.transactionHash,blockNumber:t.blockNumber}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ct(){return(ct=V(F().mark((function t(e,r,a){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I(e,r,1023,function(){var t=V(F().mark((function t(e,r){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,st(e,r,a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function pt(t,e,r,a,n){return lt.apply(this,arguments)}function lt(){return(lt=V(F().mark((function t(e,r,a,n,o){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.queryFilter(a.filters.PayloadQueued(),e,r);case 2:return t.abrupt("return",t.sent.sort((function(t,e){return e.blockNumber-t.blockNumber})).map((function(t){return{payloadId:t.args.payloadId,chainId:o,transactionHash:t.transactionHash,blockNumber:t.blockNumber,payloadsController:n}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dt(){return(dt=V(F().mark((function t(e,r,a,n,o){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I(e,r,1023,function(){var t=V(F().mark((function t(e,r){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pt(e,r,a,n,o);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ft(t,e,r,a,n){return mt.apply(this,arguments)}function mt(){return(mt=V(F().mark((function t(e,r,a,n,o){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.queryFilter(a.filters.PayloadExecuted(),e,r);case 2:return t.abrupt("return",t.sent.sort((function(t,e){return e.blockNumber-t.blockNumber})).map((function(t){return{payloadId:t.args.payloadId,chainId:o,transactionHash:t.transactionHash,blockNumber:t.blockNumber,payloadsController:n}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ht(){return(ht=V(F().mark((function t(e,r,a,n,o){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I(e,r,1023,function(){var t=V(F().mark((function t(e,r){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft(e,r,a,n,o);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xt(t,e){return{id:t,forVotes:e.proposalData.forVotes.toString(),againstVotes:e.proposalData.againstVotes.toString(),startTime:e.proposalData.startTime,endTime:e.proposalData.endTime,votingClosedAndSentBlockNumber:e.proposalData.votingClosedAndSentBlockNumber.toNumber(),votingClosedAndSentTimestamp:e.proposalData.votingClosedAndSentTimestamp,l1BlockHash:(null==e?void 0:e.voteConfig.l1ProposalBlockHash)||c.ethers.constants.HashZero,strategy:e.strategy,sentToGovernance:e.proposalData.sentToGovernance,createdBlock:e.proposalData.creationBlockNumber.toNumber(),votedInfo:{support:e.votedInfo.support,votingPower:e.votedInfo.votingPower.toString()},votingAssets:e.votingAssets,hasRequiredRoots:e.hasRequiredRoots}}function gt(t,e,r,a){return vt.apply(this,arguments)}function vt(){return(vt=V(F().mark((function t(e,r,a,n){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.queryFilter(e.filters.VoteEmitted(),r,a);case 2:return t.abrupt("return",t.sent.sort((function(t,e){return e.blockNumber-t.blockNumber})).map((function(t){return{proposalId:t.args.proposalId.toNumber(),address:t.args.voter.toString(),support:t.args.support,votingPower:A(t.args.votingPower.toString(),18).toNumber(),transactionHash:t.transactionHash,blockNumber:t.blockNumber,chainId:n}})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yt(){return(yt=V(F().mark((function t(e,r,a,n,o){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",I(r,e,a,function(){var t=V(F().mark((function t(e,r){return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,gt(n,e,r,o);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function bt(t,e){return e+"/"+t}var Pt={},wt=["0x0000000000000000000000000000000000000000000000000000000000000020",c.ethers.constants.HashZero];function St(){return(St=V(F().mark((function t(e,r,a,n){var o,i,s,u,c,p,f;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===r&&(r="https://ipfs.io/ipfs"),o=e.startsWith("0x")?l.base58.encode(Buffer.from("1220"+e.slice(2),"hex")):e,!Pt[o]){t.next=4;break}return t.abrupt("return",Pt[o]);case 4:if(!wt.some((function(t){return e===t}))){t.next=12;break}if(!a){t.next=9;break}a(e,n),t.next=10;break;case 9:throw Error("Fetch metadata form ipfs not working");case 10:t.next=37;break;case 12:return t.next=14,fetch(bt(o,r));case 14:if((i=t.sent).ok){t.next=21;break}if(!a){t.next=20;break}a(e),t.next=21;break;case 20:throw Error("Fetch metadata form ipfs not working");case 21:return s=i.clone(),t.prev=22,t.next=25,i.json();case 25:c=d((u=t.sent).description),Pt[o]={title:u.title,aip:u.aip,originalIpfsHash:e,author:u.author,discussions:u.discussions,shortDescription:u.shortDescription,ipfsHash:o,description:c.content},t.next=37;break;case 30:return t.prev=30,t.t0=t.catch(22),t.next=34,s.text();case 34:p=d(t.sent),Pt[o]={title:(f=p.data).title,aip:f.aip,originalIpfsHash:e,author:f.author,discussions:f.discussions,shortDescription:f.shortDescription,ipfsHash:o,description:p.content};case 37:return t.abrupt("return",Pt[o]);case 38:case"end":return t.stop()}}),t,null,[[22,30]])})))).apply(this,arguments)}exports.appConfigInit=function(t,e){return{providers:t,govCoreChainId:S[e],govCoreConfig:b[e],votingMachineConfig:w[e],votingMachineChainIds:E[e],payloadsControllerConfig:P[e],payloadsControllerChainIds:C[e],additional:D[e],gelatoApiKeys:k}},exports.blockLimit=1023,exports.checkHash=B,exports.formatDiff=W,exports.formatProposal=function(t){var e=G({proposalData:t.data,quorum:t.config.quorum,differential:t.config.differential,precisionDivider:t.precisionDivider,cooldownPeriod:t.timings.cooldownPeriod,executionPayloadTime:t.timings.executionPayloadTime}),r=e.forVotes,a=e.normalizeMinQuorumVotes,n=e.againstVotes,o=e.normalizeRequiredDiff,i=function(t){var e=G({proposalData:t.data,quorum:t.config.quorum,differential:t.config.differential,precisionDivider:t.precisionDivider,cooldownPeriod:t.timings.cooldownPeriod,executionPayloadTime:t.timings.executionPayloadTime}),r=e.isVotingEnded,a=e.isVotingStarted,n=e.isExpired,o=e.lastPayloadExecutedAt,i=e.lastPayloadCanceledAt,s=e.lastPayloadExpiredAt,u=e.allPayloadsExpired,c=e.isCanceled;return t.state!==exports.ProposalState.Created||n||c?t.data.votingMachineState!==exports.VotingMachineProposalState.NotCreated||n||c?!B(t.data.snapshotBlockHash).notZero||a||n||c?r||!a||n||c?a&&r&&t.state!==exports.ProposalState.Executed&&!n&&!c?t.data.votingMachineData.endTime>0?t.data.votingMachineData.endTime:t.data.creationTime+t.config.coolDownBeforeVotingStart:t.state===exports.ProposalState.Defeated?t.data.votingMachineData.endTime:t.state===exports.ProposalState.Executed?o:t.state===exports.ProposalState.Canceled?i>t.data.canceledAt?i:t.data.canceledAt:t.data.basicState===exports.BasicProposalState.Executed&&u?s:t.data.creationTime+t.timings.expirationTime:t.data.votingMachineData.startTime:t.data.votingActivationTime:t.data.creationTime+t.config.coolDownBeforeVotingStart:t.data.creationTime}(t),s=Q(t,t.data.votingMachineData.forVotes,t.data.votingMachineData.againstVotes),c=s.estimatedState,p=s.timestampForEstimatedState,l=j(t),d=new u.BigNumber(t.data.votingMachineData.forVotes).plus(t.data.votingMachineData.againstVotes),f=t.balances.map((function(t){return N(t.basicValue).toNumber()})).reduce((function(t,e){return t+e}),0),m=t.balances.map((function(t){return N(t.value).toNumber()})).reduce((function(t,e){return t+e}),0),h=t.balances,x=a-n>o?a-n:n+o,g=0===r?0:r+o;return{forPercent:d.gt(0)?new u.BigNumber(r).dividedBy(x).multipliedBy(100).toNumber():0,forVotes:r,againstPercent:d.gt(0)?new u.BigNumber(n).dividedBy(g>0?g:1).multipliedBy(100).toNumber():0,againstVotes:n,minQuorumVotes:a,requiredDiff:o,requiredForVotes:x,requiredAgainstVotes:g,stateTimestamp:i,estimatedState:c,timestampForEstimatedState:p,waitForState:l,votingPowerBasic:f,votingPower:m,votedPower:A(t.data.votingMachineData.votedInfo.votingPower,18).toNumber(),votingTokens:h}},exports.formatQuorum=L,exports.formatVotingMachineData=xt,exports.getBlockNumberByTimestamp=function(t,e,r){return _.apply(this,arguments)},exports.getBlocksForEvents=function(t,e,r,a){var n=r&&r>0&&r<t?r:a&&isFinite(a)&&a>e&&a<t?a+1:t>e+1023?e+1023:t;return{startBlock:a&&isFinite(a)&&a>e&&a<t&&a<n?a:e<t?e:t-1023,endBlock:n}},exports.getDetailedProposalsData=function(t,e,r,a){for(var n=[],o=function(){var r=t[i],o=e.find((function(t){return t.proposalData.id.toNumber()===r.id.toNumber()}))||e[i],s={id:r.id.toNumber(),votingDuration:+(null==o?void 0:o.voteConfig.votingDuration)||+r.proposalData.votingDuration,creationTime:+r.proposalData.creationTime,accessLevel:+r.proposalData.accessLevel,basicState:+r.proposalData.state,queuingTime:+r.proposalData.queuingTime,ipfsHash:r.proposalData.ipfsHash,initialPayloads:r.proposalData.payloads.map((function(t){return{id:t.payloadId,chainId:t.chain.toNumber(),payloadsController:t.payloadsController}})),snapshotBlockHash:r.proposalData.snapshotBlockHash,creator:r.proposalData.creator,canceledAt:r.proposalData.cancelTimestamp,votingActivationTime:r.proposalData.votingActivationTime,votingChainId:r.votingChainId.toNumber(),votingMachineData:xt(r.id.toNumber(),o),prerender:!!a};n.push(s)},i=0;i<r.length;i++)o();return n},exports.getEstimatedState=Q,exports.getEventsBySteps=I,exports.getGovCoreConfigs=function(t,e){return R.apply(this,arguments)},exports.getLink=bt,exports.getPayloadsCreated=function(t,e,r,a,n){return K.apply(this,arguments)},exports.getPayloadsExecuted=function(t,e,r,a,n){return ht.apply(this,arguments)},exports.getPayloadsQueued=function(t,e,r,a,n){return dt.apply(this,arguments)},exports.getProposalActivated=function(t,e,r){return tt.apply(this,arguments)},exports.getProposalActivatedOnVM=function(t,e,r){return at.apply(this,arguments)},exports.getProposalCreated=function(t,e,r){return X.apply(this,arguments)},exports.getProposalMetadata=function(t,e,r,a){return St.apply(this,arguments)},exports.getProposalQueued=function(t,e,r){return ct.apply(this,arguments)},exports.getProposalState=function(t){var e=M({},(function(t){if(null==t)throw new TypeError("Cannot destructure "+t)}(t),t)),r=G(e),a=r.forVotes,n=r.againstVotes,o=r.quorumReached,i=r.normalizeRequiredDiff,s=r.isVotingEnded,u=r.isVotingFailed,c=r.isExpired,p=r.allPayloadsExecuted,l=r.isCanceled,d=r.isPayloadsExecuted;return!l&&e.proposalData.votingMachineState===exports.VotingMachineProposalState.NotCreated&&e.proposalData.basicState<=exports.BasicProposalState.Active?exports.ProposalState.Created:r.isVotingActive&&B(e.proposalData.snapshotBlockHash).notZero?exports.ProposalState.Active:s&&!l&&a>n+i&&o&&!p&&!c?exports.ProposalState.Succeed:u&&!l?exports.ProposalState.Defeated:l?exports.ProposalState.Canceled:d?exports.ProposalState.Executed:exports.ProposalState.Expired},exports.getProposalStepsAndAmounts=G,exports.getProposalVotingClosed=function(t,e,r){return it.apply(this,arguments)},exports.getVoters=function(t,e,r,a,n){return yt.apply(this,arguments)},exports.getVotingMachineProposalState=function(t){var e=p().unix();return 0===t.votingMachineData.startTime?exports.VotingMachineProposalState.NotCreated:e<=t.votingMachineData.endTime?exports.VotingMachineProposalState.Active:0===t.votingMachineData.votingClosedAndSentBlockNumber?exports.VotingMachineProposalState.Finished:exports.VotingMachineProposalState.SentToGovernance},exports.getWaitForState=j,exports.govCoreConfig=b,exports.ipfsGateway="https://ipfs.io/ipfs",exports.normalize=function(t,e){return A(t,e).toString(10)},exports.normalizeBN=A,exports.normalizeVotes=H,exports.payloadsControllerChainIds=C,exports.payloadsControllerConfig=P,exports.updateVotingMachineData=function(t,e,r){var a=[];return r.forEach((function(r){var n=t.find((function(t){return(null==t?void 0:t.id)===r}));if(n){var o=e.find((function(t){return t.proposalData.id.toNumber()===n.id}))||e[0],i={id:n.id,votingDuration:+(null==o?void 0:o.voteConfig.votingDuration)||n.votingDuration,creationTime:n.creationTime,accessLevel:n.accessLevel,basicState:n.basicState,queuingTime:n.queuingTime,ipfsHash:n.ipfsHash,initialPayloads:n.initialPayloads,snapshotBlockHash:n.snapshotBlockHash,creator:n.creator,canceledAt:n.canceledAt,votingActivationTime:n.votingActivationTime,votingChainId:n.votingChainId,votingMachineData:xt(n.id,o),prerender:n.prerender};a.push(i)}})),a},exports.valueToBigNumber=N,exports.votingMachineChainIds=E;
//# sourceMappingURL=aave-governance-ui-helpers.cjs.production.min.js.map
