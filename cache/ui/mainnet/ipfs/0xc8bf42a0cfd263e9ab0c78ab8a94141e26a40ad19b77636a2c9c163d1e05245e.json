{
  "ipfsHash": "QmbrHQC19xQUQUqr1Br3QekG9YB3StWqQPRcV5hnjA7b81",
  "description": "\n## Simple Summary\n\nFollowing the approval of [Risk Agents](https://governance.aave.com/t/technical-maintenance-proposals/15274/122), this proposal migrates all existing injector middleware infra used to perform automated risk updates to the new chaos agents system.\n\n## Motivation\n\nCurrently, the AGRS, in conjunction with the injector system, is responsible for processing highly constrained risk recommendations for a range of parameters, including supply and borrow caps, interest rates, pendle pt e-mode collateral params, and CAPO values across multiple assets and Aave instances. These updates are executed through the injector middleware, which consumes updates from the chaos risk oracles and injects updates onto the Aave protocol in real-time.\n\nWhile the existing system has served Aave more than well, several limitations exist:\n\n- Limited generalization: Almost every Risk Stewards activation requires ad-hoc replication of the entire architecture. This results in meaningful overhead for Aave SPs.\n- Limited infrastructure visibility: Tracking all active Risk Stewards, as well as their covered assets and constraints, can be challenging at times.\n\nThe Chaos Risk Agents framework generalizes and modularizes the process of ingesting Risk Oracle data within Aave. It eliminates redundant deployments, centralizes validation logic, and improves visibility across all risk automation layers. The result is a cleaner, more maintainable architecture that allows Aave to expand real-time risk management capabilities, ensuring consistent, verifiable execution of parameter updates.\n\n## Specification\n\nAll the current automated risk param updates will be migrated from the old injector infra to the chaos-agent system, including the following:\n\n| Risk Param                                    | Network Instance                                          | Constrains                                                             |\n| --------------------------------------------- | --------------------------------------------------------- | ---------------------------------------------------------------------- |\n| Supply and Borrow Caps                        | Arbitrum, Avalanche, Base, BNB, Gnosis, Optimism, Polygon | max 30% relative change / 3 days                                       |\n| Pendle EMode Collateral Param                 | EthereumCore, Plasma                                      | max 0.5% absolute change / 3 days for LT, LTV, LB                      |\n| Pendle Discount Rate                          | EthereumCore, Plasma                                      | max 1% absolute change / 2 days                                        |\n| Interest Rate: Base, Slope1, Slope2, uOptimal | EthereumPrime                                             | max 3% uOpt, 0.5% base, 0.5% slope1, 5% slope2 absolute change / 1 day |\n| Interest Rate: Slope2                         | EthereumCore, Linea                                       | max 4% absolute change / 8 hours                                       |\n\nWhitelisted Assets / Markets configured by agent:\n\n|                                      | Whitelisted Assets / Markets                                                                                                                               |\n| ------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |\n| Arbitrum Supply / Borrow Caps        | WETH, USDC, USDT, WBTC, DAI, weETH, ARB, USDC.e, GHO, LINK, wstETH, LUSD, FRAX, rETH, AAVE                                                                 |\n| Avalanche Supply / Borrow Caps       | WETHe, USDCe, USDTe, WBTCe, DAIe, LINKe, AAVEe, WAVAX, sAVAX, FRAX, MAI, BTCb, AUSD                                                                        |\n| Base Supply / Borrow Caps            | WETH, cbETH, USDC, USDbC, weETH, GHO, wstETH, cbBTC, LBTC, EURC                                                                                            |\n| BNB Supply / Borrow Caps             | ETH, wstETH, BTCB, USDC, USDT, WBNB                                                                                                                        |\n| Gnosis Supply / Borrow Caps          | WETH, wstETH, USDCe, sDAI, EURe, GNO                                                                                                                       |\n| Optimism Supply / Borrow Caps        | WETH, wstETH, rETH, WBTC, USDC, USDT, OP                                                                                                                   |\n| Polygon Supply / Borrow Caps         | WETH, wstETH, WBTC, USDC, USDC.e, USDT, DAI, AAVE, LINK, WPOL                                                                                              |\n| EthereumCore Pendle EMode Collateral | EMode Ids: 8, 9, 10, 12, 13, 14, 17, 18, 19, 20, 24, 25, 27, 28, 29, 30, 31, 32                                                                            |\n| Plasma Pendle EMode Collateral       | EMode Ids: 5, 6, 7, 8, 13, 14, 15, 16                                                                                                                      |\n| EthereumCore Pendle Discount Rate    | PT_sUSDe_31JUL25, PT_USDe_31JUL25, PT_eUSDe_14AUG25, PT_sUSDe_25SEP25, PT_USDe_25SEP25, PT_sUSDe_27NOV25, PT_USDe_27NOV25, PT_sUSDe_5FEB26, PT_USDe_5FEB26 |\n| Plasma Pendle Discount Rate          | PT_sUSDe_15JAN26, PT_USDe_15JAN26, PT_sUSDE_9APR26, PT_USDE_9APR26                                                                                         |\n| EthereumPrime Interest Rate          | WETH                                                                                                                                                       |\n| EthereumCore Slope2 Interest Rate    | WETH, USDC, USDT, USDe                                                                                                                                     |\n| Linea Slope2 Interest Rate           | WETH, USDC, USDT                                                                                                                                           |\n\n_Please note: The whitelisted assets and the constraints are the same as previously on the AGRS injector infra. This proposal only migrates the existing automated AGRS system using injector infrastructure; there is no change to the manual AGRS system, and updates on it using the new infra will be applied at a different AIP._\n\nThe risk agent contracts have not been pre-configured during deployment, and all operations, will be done on the payload:\n\n- Register new agents on the AgentHub contract by calling `registerAgent()`\n- Configure constrained ranges on the `RangeValidationModule` to strictly bound the risk param update from the Chaos Risk Oracle.\n- Give `RISK_ADMIN` role to the AgentContract which will be called by the Chaos Agent system to inject updates onto the Aave protocol.\n- Revoke `RISK_ADMIN` role from the previous injector contracts, as this system will be unused.\n- Cancel previous injector automation and register new ones on the AgentHub Automation wrapper contract. This is done only on networks where we use Chainlink automation, on Linea, Gnosis, and Plasma networks, this will be done off-chain using the DAO account on Gelato automation.\n- Reimburse BGD Labs with 120 LINK by withdrawing aLINK from Collector on Ethereum, which was used to fund chainlink automation on BNB, Base networks as Collector did not have LINK on those networks.\n\nAll configurations used on the proposal payload could be found on the [AgentConfigLib](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/AgentConfigLib.sol).\n\nMore detailed specifications can be found on the [chaos-agents-migration](https://github.com/bgd-labs/chaos-agents-migration) repo.\n\n### Security\n\nChaos Risk Agent contracts is independently audited by [Zellic](https://github.com/ChaosLabsInc/chaos-agents/blob/f02af714ef069e54bae577ac2d34bb3d57d6e1cd/audits/zellic/v1-zellic.pdf) and [Hexens](https://github.com/ChaosLabsInc/chaos-agents/blob/f02af714ef069e54bae577ac2d34bb3d57d6e1cd/audits/hexens/v1-hexens.pdf). In addition, the migration proposal payload and setup has been reviewed by Certora.\n\n### Permissions\n\nDetailed permissions post payload execution of the Chaos Risk Agent could be found on the [permissions-book](https://github.com/aave-dao/aave-permissions-book/compare/47474555dcf6a3d5ce45a0bab7de7bb6d87c1690..33e2307e063e4e21db2408d606ff9bb7a7885ddf), but to summarize (for all networks):\n\n| Role                                | Entity                    |\n| ----------------------------------- | ------------------------- |\n| AgentHub Owner                      | Governance Executor Lvl 1 |\n| AgentHub ProxyAdmin owner           | Governance Executor Lvl 1 |\n| Agent Admin                         | Governance Executor Lvl 1 |\n| RangeValidationModule Config Update | Governance Executor Lvl 1 |\n| `RISK_ADMIN` on ACL Manager         | Each Agent contract       |\n\n### Addresses\n\nAll Agents Hub addresses per network can be found on [Aave Address Book](https://search.onaave.com/?q=agent%20hub).\n\n## References\n\n- Implementation: [BaseMigrationPayload](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/BaseMigrationPayload.sol), [AaveV3Ethereum](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/EthereumCoreMigrationPayload.sol), [AaveV3EthereumPrime](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/EthereumPrimeMigrationPayload.sol), [AaveV3Ethereum_ReimburseLinkForRobot](https://github.com/bgd-labs/aave-proposals-v3/blob/f1f657065c0b6689289710fd8d2e1ceb199a8a91/src/20251201_Multi_MigrateAutomatedRiskUpdateInfraToChaosAgents/AaveV3Ethereum_ReimburseLinkForRobot_20251201.sol), [AaveV3Polygon](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/PolygonMigrationPayload.sol), [AaveV3Avalanche](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/AvalancheMigrationPayload.sol), [AaveV3Optimism](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/OptimismMigrationPayload.sol), [AaveV3Arbitrum](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/ArbitrumMigrationPayload.sol), [AaveV3Base](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/BaseNetworkMigrationPayload.sol), [AaveV3Gnosis](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/GnosisMigrationPayload.sol), [AaveV3BNB](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/BNBMigrationPayload.sol), [AaveV3Linea](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/LineaMigrationPayload.sol), [AaveV3Plasma](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/src/contracts/payloads/PlasmaMigrationPayload.sol)\n- Tests: [BaseMigrationTest](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/BaseMigrationPayload.t.sol), [AaveV3Ethereum](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/EthereumCoreMigrationPayload.t.sol), [AaveV3EthereumPrime](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/EthereumPrimeMigrationPayload.t.sol), [AaveV3Ethereum_ReimburseLinkForRobot](https://github.com/bgd-labs/aave-proposals-v3/blob/f1f657065c0b6689289710fd8d2e1ceb199a8a91/src/20251201_Multi_MigrateAutomatedRiskUpdateInfraToChaosAgents/AaveV3Ethereum_ReimburseLinkForRobot_20251201.t.sol), [AaveV3Polygon](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/PolygonMigrationPayload.t.sol), [AaveV3Avalanche](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/AvalancheMigrationPayload.t.sol), [AaveV3Optimism](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/OptimismMigrationPayload.t.sol), [AaveV3Arbitrum](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/ArbitrumMigrationPayload.t.sol), [AaveV3Base](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/BNBMigrationPayload.t.sol), [AaveV3Gnosis](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/GnosisMigrationPayload.t.sol), [AaveV3BNB](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/BNBMigrationPayload.t.sol), [AaveV3Linea](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/LineaMigrationPayload.t.sol), [AaveV3Plasma](https://github.com/bgd-labs/chaos-agents-migration/blob/88bb6f3c4e043960f8cb42741ebe13c46c73b944/tests/payloads/PlasmaMigrationPayload.t.sol)\n- [Snapshot](https://snapshot.org/#/s:aavedao.eth/proposal/0x9795f1b7057d2780b3382b9f67f309fbfead98e7357a88df4c309dbbfefcbeb7)\n- [Discussion](https://governance.aave.com/t/technical-maintenance-proposals/15274/122)\n- Github: [Chaos Agents](https://github.com/ChaosLabsInc/chaos-agents), [Aave Risk Agents](https://github.com/bgd-labs/aave-agents), [Migration Payload](https://github.com/bgd-labs/chaos-agents-migration)\n\n## Copyright\n\nCopyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).\n",
  "title": "AGRS (Risk Stewards) migration to Risk Agents",
  "author": "BGD Labs (@bgdlabs)",
  "discussions": "https://governance.aave.com/t/technical-maintenance-proposals/15274/122",
  "snapshot": "https://snapshot.org/#/s:aavedao.eth/proposal/0x9795f1b7057d2780b3382b9f67f309fbfead98e7357a88df4c309dbbfefcbeb7",
  "originalIpfsHash": "0xc8bf42a0cfd263e9ab0c78ab8a94141e26a40ad19b77636a2c9c163d1e05245e"
}